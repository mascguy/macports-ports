--- CMakeLists.txt.orig	2025-03-09 15:04:01.000000000 -0400
+++ CMakeLists.txt	2025-03-09 15:04:41.000000000 -0400
@@ -344,7 +344,9 @@
                    COMMENT "Creating ${PROJECT_BINARY_DIR}/vigra-${vigra_version}-src.tar.gz")
 
 ADD_DEPENDENCIES(PACKAGE_SRC_TAR check)
-ADD_DEPENDENCIES(PACKAGE_SRC_TAR doc_cpp)
+if(BUILD_DOCS)
+    ADD_DEPENDENCIES(PACKAGE_SRC_TAR doc_cpp)
+ENDIF()
 IF(WITH_VIGRANUMPY AND PYTHON_SPHINX)
     ADD_DEPENDENCIES(PACKAGE_SRC_TAR doc_python)
 ENDIF()
--- vigranumpy/docsrc/CMakeLists.txt.orig	2025-03-09 15:08:32.000000000 -0400
+++ vigranumpy/docsrc/CMakeLists.txt	2025-03-09 15:10:02.000000000 -0400
@@ -1,4 +1,4 @@
-IF(PYTHON_SPHINX)
+IF(BUILD_DOCS AND PYTHON_SPHINX)
     # vigranumpy documentation generation using sphinx
     IF(DEFINED VIGRANUMPY_DOCDIR)
         MESSAGE(SEND_ERROR "VIGRANUMPY_DOCDIR already defined! Please delete from Cache.")
@@ -81,7 +81,7 @@
     ADD_DEPENDENCIES(doc_python vigranumpy)
     ADD_DEPENDENCIES(doc_python doc_cpp)
 
-ELSE(PYTHON_SPHINX)
+ELSE(BUILD_DOCS AND PYTHON_SPHINX)
     # no vigranumpy documentation if sphinx not available
     ADD_CUSTOM_TARGET (doc_python
         ${CMAKE_COMMAND} -E echo
--- docsrc/CMakeLists.txt.orig	2025-03-09 15:10:58.000000000 -0400
+++ docsrc/CMakeLists.txt	2025-03-09 15:12:27.000000000 -0400
@@ -1,4 +1,4 @@
-IF(DOXYGEN_FOUND AND Python_Interpreter_FOUND)
+IF(BUILD_DOCS AND DOXYGEN_FOUND AND Python_Interpreter_FOUND)
     execute_process(COMMAND ${DOXYGEN_EXECUTABLE} --version
                   OUTPUT_VARIABLE DOXYGEN_VERSION OUTPUT_STRIP_TRAILING_WHITESPACE)
 
@@ -45,23 +45,23 @@
             ${DOCDIR}/vigra/documents/tutorial_reference.pdf
         COMMENT "Postprocessing html files")
 
+    # create fallback index.html that simply refers to the online documentation
+    file(MAKE_DIRECTORY ${DOCDIR}/vigra)
+    file(GLOB INDEX_HTML_EXISTS ${DOCDIR}/vigra/index.html)
+    configure_file(vigra-icon.ico ${DOCDIR}/vigra/vigra-icon.ico COPYONLY)
+    if(NOT INDEX_HTML_EXISTS)
+        configure_file(index_fallback.html ${DOCDIR}/vigra/index.html COPYONLY)
+        configure_file(vigra.css ${DOCDIR}/vigra/vigra.css COPYONLY)
+    endif()
+
+    INSTALL(DIRECTORY ${DOCDIR}/
+        DESTINATION ${DOCINSTALL}/)
+
+ADD_DEPENDENCIES(doc doc_cpp)
+
 ELSE()
     ADD_CUSTOM_TARGET (doc_cpp 
         COMMAND ${CMAKE_COMMAND} -E echo
             \"Cannot generate C++ documentation -- doxygen or Python not found.\")
 
 ENDIF()
-
-# create fallback index.html that simply refers to the online documentation
-file(MAKE_DIRECTORY ${DOCDIR}/vigra)
-file(GLOB INDEX_HTML_EXISTS ${DOCDIR}/vigra/index.html)
-configure_file(vigra-icon.ico ${DOCDIR}/vigra/vigra-icon.ico COPYONLY)
-if(NOT INDEX_HTML_EXISTS)
-    configure_file(index_fallback.html ${DOCDIR}/vigra/index.html COPYONLY)
-    configure_file(vigra.css ${DOCDIR}/vigra/vigra.css COPYONLY)
-endif()
-
-INSTALL(DIRECTORY ${DOCDIR}/
-         DESTINATION ${DOCINSTALL}/)
-
-ADD_DEPENDENCIES(doc doc_cpp)
--- CMakeLists.txt.orig	2025-03-09 15:14:41.000000000 -0400
+++ CMakeLists.txt	2025-03-09 15:15:40.000000000 -0400
@@ -346,9 +346,10 @@
 ADD_DEPENDENCIES(PACKAGE_SRC_TAR check)
 if(BUILD_DOCS)
     ADD_DEPENDENCIES(PACKAGE_SRC_TAR doc_cpp)
-ENDIF()
-IF(WITH_VIGRANUMPY AND PYTHON_SPHINX)
-    ADD_DEPENDENCIES(PACKAGE_SRC_TAR doc_python)
+
+    IF(WITH_VIGRANUMPY AND PYTHON_SPHINX)
+        ADD_DEPENDENCIES(PACKAGE_SRC_TAR doc_python)
+    ENDIF()
 ENDIF()
 
 ##################################################
